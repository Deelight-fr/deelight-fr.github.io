---
layout: post
title: Bitcoin Challenge / 310 BTC cachés dans une image
tags: [Bitcoin]
---

Dans l'esprit du challenge du [challenge du logo de l'ANSSI](https://www.ssi.gouv.fr/actualite/le-challenge-anssi-qui-avait-ete-lance-en-fevrier-2012-a-ete-resolu/), un anonyme a lancé le 2 octobre sur [Reddit](https://www.reddit.com/r/Bitcoin/comments/9kq7it/introducing_the_310_btc_bitcoin_challenge) et [BitcoinTalk](https://bitcointalk.org/index.php?topic=5042285) une invitation à reveler un challenge. A la clé : 310 BTC dont l'auteur a déjà apporté la preuve cryptographique qu'ils étaient en sa possession.

Je ne me fais pas de faux espoirs, il y a des gens bien plus compétents que moi qui emporteront le prix. Cependant, la résolution de l'enigme reste un défi passionnant. J'indiquerai donc sur cette page l'état de mes recherches. N'hésitez pas à partager les votres dans les commentaires. Si vous souhaitez que l'on planche à plusieurs, n'hésitez pas non plus ; on pourrait par exemple se retrouver sur un canal IRC dédié. Bonne chance à tous !

## L'image source

![Challenge](/images/challenge.png "Challenge")

## Les pistes ##

### Le masque de transparence ###

Le PNG d'origine présente des zone légèrement transparentes invisible à l'oreil nu (opacité de 253 sur 255). Voici comment les mettre en évidence avec Gimp :

<iframe width="560" height="315" src="https://www.youtube.com/embed/63ltk3OcTq8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

Le QRcode amène vers une page du site où l'on peut tenter de valider la hash sha256 d'un fichier (je n'y suis pas encore parvenu). La ligne correspond quant-à-elle à du binaire :

```binary
0101010100110010010001100111001101100100010001110101011001101011010110000011000100111001010100010011001101001001001011110010111101010110010000110100100000110000010101010011001101100011010101100111010001001001010101000101101000110011011000110110101101001001010011000100101001101110010101010110001101100100010100000101100000110011010001110111001100110101011100010110101001100100010001100011000101010101011010100101101000110011011011010100000101100110011101000100011101101001011101100111010001000110010110010100010000001010010011100011010101011010010000110101001101101011010000100111100101101110011011100101011001110001010000100110000101110111011011000011010001110000001110000111011101001011010011110011000001001111001110000111101001001001001101100100010000110000010000010011000100101011010101100100010101010110010000110101010101111001010001010111011001000101011001010100111001101111010101010110011001000111011000110101001100110000010001010110110000111001011001000011100100110011011101100111001101010000011110000110001001100111001101110000101001000100001101010110000101110110011101010110011001010001011100110101001101100011011001110111001101101011001100110101000101000101011101000111000100111001001011110100110100110100010001000110111100110011001100100100111101001011010001100110010101110001001100000011000000101111001100110100111001110010011110000101011101001111011100110100110101101101011010000011001101000001010110000110110101000100011110100111010101110101010110100011000001110001011011010101101001100001010010010011011101110010011001010011000100110110000010100100011001100011010110000100100101110010011011010101000001010000011010010101000101000100010011110100100001010010011000110011011101110111011101000011000001101110011001110011011001110001010011000110100101001110011110100011011101010110011100010100010101010011010100100101010001100100011110000101000001001111011000010110100001001011010001100101001001101011010101110101010000111000011100110101010000101011010101010111001000110010011110010010101100110010011010010101101000110010010011000100010101100001011110000100111000001010010011010011011101010101010110100111000101100011010100000111011101011001011001110110110100110110010001100110111101001011010011110101011001101010011011100111000101100100011001010110011100110011001100000101001000110010001101110110101001100011001101100100000101101111010001100101000001111001010100100101101000110010011001110011100000101011010001010100101001001101011100000011001101101110001011110111000001100110001110010011010001101111010100110100001101001100010001010101011101101011011000110011000001101111011100110000101001101010010010000011100101000100011100010110001001001101001101100100010001010101011100000111010001110101001100110100100001001010011000100100000101010110011101110101100001010001001111010011110100001010
```

Converti en ASCII, cela donne

```ascii
U2FsdGVkX19Q3I//VCH0U3cVtITZ3ckILJnUcdPX3Gs5qjdF1UjZ3mAftGivtFYD
N5ZCSkBynnVqBawl4p8wKO0O8zI6D0A1+VEVCUyEvEeNoUfGcS0El9d93vsPxbg7
D5avufQsScgsk3QEtq9/M4Do32OKFeq00/3NrxWOsMmh3AXmDzuuZ0qmZaI7re16
FcXIrmPPiQDOHRc7wt0ng6qLiNz7VqESRTdxPOahKFRkWT8sT+Ur2y+2iZ2LEaxN
M7UZqcPwYgm6FoKOVjnqdeg30R27jc6AoFPyRZ2g8+EJMp3n/pf94oSCLEWkc0os
jH9DqbM6DUptu3HJbAVwXQ==
```

C'est visiblement un fichier de 256 octets chiffré via OpenSSL. Reste à trouver l'algorithme de chiffrement et la clé.

### Le canal rouge ###

Le canal rouge de l'image originale diffère des autres. En fisant une soustraction de couches sous Gimp, on met en evidence ces pixels :

![Challenge](/images/challenge-redline.png "Challenge")

L'interprétation binaire de la ligne mise en évidence ne m'a pour le moment rien appris (pas de format spécifique reconnu)

```binary
0101101110111011000111011101011100100110011110100111001000110000010110000011001001111101000100010110011101000000101100110010101010000110100001011111100111011000000010010100010111110100100001111100111100010110001001010111001100100110101011111100100001010011111011001001110110000011100100101101101100100100101001000001000000100000000100110001101011111001111101011000010110001011001111011111010101100001011100011010101001010001100011000000111101101111101011010001011001001011110110110011000010000110001011111011000110110100011001000010001000001010101010101000001000110111011000000001101110110100000101111011011101101000100011110101101010111001101001001110000110101100011101001100000110011110100111010011100101101000111000100101001000001001111111011001011011011001011011011011010100010111011010000000101000101011011010100100001101110111001111001111000000111000110010101111111110000011100100001101110110100110010101011101000100010101001001110110110010110001000011110111100101000010001010010111111111111010100010000010111111110010100001110011011011010011010101000110010110110010011110111110000001101000111110100001101011010010000110010000100111010000001101111101000010110010100110111110100000010110001010110010001011010110110111100111101001101110011100010111001110000000010010110111000111100100111101010010000100000111110101010111100011011111000011101001110001001110101001101000010011111000010101110011011111011001101110101011111011001010010011111000000000100000000010011000001100010000111101101010100000101100101010100011101111101000010000110011000011010101001101100001000111110011000110100110101000110111000110000100011110100000011100110001001011001101010010001100111111000101001110101010110010100001100100100100100111000111101000011001111110110000000010011011011100111100111000101101101010110100001111001111001111110000111011111011111101000010111001000001000100100100100111111001111010100000100110000101100010010100010000110001110001101001101110011111111001100110001000101110010100110010011110000010101000110101000001100001111001011010110010000101110000110110101101101011010111110101001000101100100010101010011110001001111101101010011011110011000001011101000011111111000100111000000100010110110100011000111000001010101000011100101110010111000101100001011011000101010100110010001100000011001000110010001101110111110111101100111001011110110100100011001100001100011101111001010100100101101000001110011001100011100001001011010001010100101001011110101111111100110010000010011000110000011011110001000110100011101101100111011011000010110011001000001011011100001101101011011100100011001000111100110111110100011000011100101111110011100101000101011110000111001001001100011101100000110001011101011010000110010101110111011001001010010100010111100101011101011001110101100101110101000101010101001111101101110101101010011011111110000011101110001100010000000000010011100000000000000101000000110111000001001111110110111110001001000000011111100101110110001111100000
```

Pas mieux en inversé :

```
1010010001000100111000100010100011011001100001011000110111001111101001111100110110000010111011101001100010111111010011001101010101111001011110100000011000100111111101101011101000001011011110000011000011101001110110101000110011011001010100000011011110101100000100110110001001111100011011010010010011011011010110111110111111011111111011001110010100000110000010100111101001110100110000100000101010011110100011100101010110101110011100111111000010010000010100101110100110110100001001001100111101111001110100000100111001001011100110111101110111110101010101010111110111001000100111111110010001001011111010000100100010010111011100001010010101000110010110110001111001010011100010110011111001100001011000101100011010010111000111011010110111110110000000100110100100100110100100100100101011101000100101111111010111010100100101011011110010001000110000110000111111000111001101010000000001111100011011110010001001011001101010100010111011101010110110001001001101001110111100001000011010111101110101101000000000000101011101111101000000001101011110001100100100101100101010111001101001001101100001000001111110010111000001011110010100101101111001101111011000101111110010000010111101001101011001000001011111101001110101001101110100101001001000011000010110010001100011101000110001111111101101001000111000011011000010101101111011111000001010101000011100100000111100010110001110110001010110010111101100000111101010001100100000100110010001010100000100110101101100000111111111011111111101100111110011101111000010010101011111010011010101011100010000010111101111001100111100101010110010011110111000001100111001011001010111001000111001111011100001011111100011001110110100110010101101110011000000111010110001010101001101011110011011011011011000111000010111100110000001001111111101100100100011000011000111010010010101001011110000110000110000001111000100000100000010111101000110111110111011011011011000000110000101011111011001111010011101101011101111001110001110010110010001100000000110011001110111010001101011001101100001111101010111001010111110011110000110100101001101111010001111001001010010010100101000001010110111010011011101010101100001110110000010010101100100001100111110100010111100000000111011000111111011101001001011100111000111110101010111100011010001101000111010011110100100111010101011001101110011111100110111001101110010001000001000010011000110100001001011011100110011110011100010000110101011011010010111110001100110011100011110110100101110101011010110100001010000000011001101111101100111001111100100001110111001011100010010011000100100111101001100110111110100100011110010010100100011011100110111000011001000001011100111100011010000001100011010111010100001111000110110110011100010011111001110100010100101111001101010001000100110110101101011101000011010100010100110001010011010001010111010101010110000010010001010010101100100000001111100010001110011101111111111101100011111111111111010111111001000111110110000001001000001110110111111100000011010001001110000011111
```

### Les courbes de Bézier ###

Je commence à penser qu'il est possible de tracer un chemin passant par toutes les cellules contenant un caractère en utilisant les 4 courbes fournies (et des copies, éventuellement en miroir). Chaque cellule marquée semble en effet être très précisément à une courbe de distance d'une autre cellule (parfois plusieurs). L'extrémité en crochet d'une des courbes laisse penser que le chemin doit contourner certaines cellules. On peut par exemple imaginer que les courbes ne doivent pas se croiser, ou qu'il ne faut pas faire passer un chemin au dessus d'une cellule marquée. A tester.

### La trame de fond ###

Une trame de fond est détectable sur l'ensemble de l'image. On peut la mettre en évidence via une solarisation (appliquer un courbe de colorimétrique en triangle). Je n'ai rien pu extraire de cette trame pour le moment. De plus, elle est fortement influencée par l'image d'origine. Il est peut être nécessaire de reconstituer un tuile "propre" du motif en extrayant uniquement les pixels des zones sur fond blanc.

![Challenge](/images/challenge-trame.png "Challenge")

