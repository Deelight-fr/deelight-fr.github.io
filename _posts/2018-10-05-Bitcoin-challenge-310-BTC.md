---
layout: post
title: Bitcoin Challenge / 310 BTC cachés dans une image
tags: [Bitcoin]
---

Dans l'esprit du challenge du [challenge du logo de l'ANSSI](https://www.ssi.gouv.fr/actualite/le-challenge-anssi-qui-avait-ete-lance-en-fevrier-2012-a-ete-resolu/), un anonyme a lancé le 2 octobre sur [Reddit](https://www.reddit.com/r/Bitcoin/comments/9kq7it/introducing_the_310_btc_bitcoin_challenge) et [BitcoinTalk](https://bitcointalk.org/index.php?topic=5042285) une invitation à relever un challenge. Trouvé la clé privée d'un wallet Bitcoin [cachée dans une image](https://bitcoinchallenge.codes). A la clé : 310 BTC dont l'auteur a déjà apporté la preuve cryptographique qu'ils étaient en sa possession.

Je ne me fais pas de faux espoirs, il y a des gens bien plus compétents que moi qui emporteront le prix. Cependant, la résolution de l'enigme reste un défi passionnant. J'indiquerai donc sur cette page l'état de mes recherches. N'hésitez pas à partager les votres dans les commentaires. Si vous souhaitez que l'on planche à plusieurs, n'hésitez pas non plus ; on pourrait par exemple se retrouver sur un canal IRC dédié. Bonne chance à tous !

## L'image source

![Challenge](/images/challenge.png "Challenge")

## Les pistes ##

### Le masque de transparence ###

Le PNG d'origine présente des zone légèrement transparentes invisible à l'oreil nu (opacité de 253 sur 255). Voici comment les mettre en évidence avec Gimp :

<iframe width="560" height="315" src="https://www.youtube.com/embed/63ltk3OcTq8" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>

Le QRcode amène vers une [page du site](https://bitcoinchallenge.codes/register-310/) où l'on peut tenter de valider la hash sha256 d'un fichier (je n'y suis pas encore parvenu). La ligne correspond quant-à-elle à du binaire :

```
01010101001100100100011001110011011001000100011101010110011010110101100000110001
00111001010100010011001101001001001011110010111101010110010000110100100000110000
01010101001100110110001101010110011101000100100101010100010110100011001101100011
01101011010010010100110001001010011011100101010101100011011001000101000001011000
00110011010001110111001100110101011100010110101001100100010001100011000101010101
01101010010110100011001101101101010000010110011001110100010001110110100101110110
01110100010001100101100101000100000010100100111000110101010110100100001101010011
01101011010000100111100101101110011011100101011001110001010000100110000101110111
01101100001101000111000000111000011101110100101101001111001100000100111100111000
01111010010010010011011001000100001100000100000100110001001010110101011001000101
01010110010000110101010101111001010001010111011001000101011001010100111001101111
01010101011001100100011101100011010100110011000001000101011011000011100101100100
00111001001100110111011001110011010100000111100001100010011001110011011100001010
01000100001101010110000101110110011101010110011001010001011100110101001101100011
01100111011100110110101100110011010100010100010101110100011100010011100100101111
01001101001101000100010001101111001100110011001001001111010010110100011001100101
01110001001100000011000000101111001100110100111001110010011110000101011101001111
01110011010011010110110101101000001100110100000101011000011011010100010001111010
01110101011101010101101000110000011100010110110101011010011000010100100100110111
01110010011001010011000100110110000010100100011001100011010110000100100101110010
01101101010100000101000001101001010100010100010001001111010010000101001001100011
00110111011101110111010000110000011011100110011100110110011100010100110001101001
01001110011110100011011101010110011100010100010101010011010100100101010001100100
01111000010100000100111101100001011010000100101101000110010100100110101101010111
01010100001110000111001101010100001010110101010101110010001100100111100100101011
00110010011010010101101000110010010011000100010101100001011110000100111000001010
01001101001101110101010101011010011100010110001101010000011101110101100101100111
01101101001101100100011001101111010010110100111101010110011010100110111001110001
01100100011001010110011100110011001100000101001000110010001101110110101001100011
00110110010000010110111101000110010100000111100101010010010110100011001001100111
00111000001010110100010101001010010011010111000000110011011011100010111101110000
01100110001110010011010001101111010100110100001101001100010001010101011101101011
01100011001100000110111101110011000010100110101001001000001110010100010001110001
01100010010011010011011001000100010101010111000001110100011101010011001101001000
01001010011000100100000101010110011101110101100001010001001111010011110100001010
```

Converti en ASCII, cela donne

```
U2FsdGVkX19Q3I//VCH0U3cVtITZ3ckILJnUcdPX3Gs5qjdF1UjZ3mAftGivtFYD
N5ZCSkBynnVqBawl4p8wKO0O8zI6D0A1+VEVCUyEvEeNoUfGcS0El9d93vsPxbg7
D5avufQsScgsk3QEtq9/M4Do32OKFeq00/3NrxWOsMmh3AXmDzuuZ0qmZaI7re16
FcXIrmPPiQDOHRc7wt0ng6qLiNz7VqESRTdxPOahKFRkWT8sT+Ur2y+2iZ2LEaxN
M7UZqcPwYgm6FoKOVjnqdeg30R27jc6AoFPyRZ2g8+EJMp3n/pf94oSCLEWkc0os
jH9DqbM6DUptu3HJbAVwXQ==
```

C'est visiblement un fichier de 256 octets chiffré via OpenSSL. Reste à trouver l'algorithme de chiffrement et la clé.

### Le canal rouge ###

Le canal rouge de l'image originale diffère des autres. En fisant une soustraction de couches sous Gimp, on met en evidence ces pixels :

![Challenge](/images/challenge-redline.png "Challenge")

L'interprétation binaire de la ligne mise en évidence ne m'a pour le moment rien appris (pas de format spécifique reconnu)

```
01011011101110110001110111010111001001100111101001110010001100000101100000110010
01111101000100010110011101000000101100110010101010000110100001011111100111011000
00001001010001011111010010000111110011110001011000100101011100110010011010101111
11001000010100111110110010011101100000111001001011011011001001001010010000010000
00100000000100110001101011111001111101011000010110001011001111011111010101100001
01110001101010100101000110001100000011110110111110101101000101100100101111011011
00110000100001100010111110110001101101000110010000100010000010101010101010000010
00110111011000000001101110110100000101111011011101101000100011110101101010111001
10100100111000011010110001110100110000011001111010011101001110010110100011100010
01010010000010011111110110010110110110010110110110110101000101110110100000001010
00101011011010100100001101110111001111001111000000111000110010101111111110000011
10010000110111011010011001010101110100010001010100100111011011001011000100001111
01111001010000100010100101111111111110101000100000101111111100101000011100110110
11010011010101000110010110110010011110111110000001101000111110100001101011010010
00011001000010011101000000110111110100001011001010011011111010000001011000101011
00100010110101101101111001111010011011100111000101110011100000000100101101110001
11100100111101010010000100000111110101010111100011011111000011101001110001001110
10100110100001001111100001010111001101111101100110111010101111101100101001001111
10000000001000000000100110000011000100001111011010101000001011001010101000111011
11101000010000110011000011010101001101100001000111110011000110100110101000110111
00011000010001111010000001110011000100101100110101001000110011111100010100111010
10101100101000011001001001001001110001111010000110011111101100000000100110110111
00111100111000101101101010110100001111001111001111110000111011111011111101000010
11100100000100010010010010011111100111101010000010011000010110001001010001000011
00011100011010011011100111111110011001100010001011100101001100100111100000101010
00110101000001100001111001011010110010000101110000110110101101101011010111110101
00100010110010001010101001111000100111110110101001101111001100000101110100001111
11110001001110000001000101101101000110001110000010101010000111001011100101110001
01100001011011000101010100110010001100000011001000110010001101110111110111101100
11100101111011010010001100110000110001110111100101010010010110100000111001100110
00111000010010110100010101001010010111101011111111001100100000100110001100000110
11110001000110100011101101100111011011000010110011001000001011011100001101101011
01110010001100100011110011011111010001100001110010111111001110010100010101111000
01110010010011000111011000001100010111010110100001100101011101110110010010100101
00010111100101011101011001110101100101110101000101010101001111101101110101101010
01101111111000001110111000110001000000000001001110000000000000010100000011011100
0001001111110110111110001001000000011111100101110110001111100000
```

Pas mieux en inversé :

```
10100100010001001110001000101000110110011000010110001101110011111010011111001101
10000010111011101001100010111111010011001101010101111001011110100000011000100111
11110110101110100000101101111000001100001110100111011010100011001101100101010000
00110111101011000001001101100010011111000110110100100100110110110101101111101111
11011111111011001110010100000110000010100111101001110100110000100000101010011110
10001110010101011010111001110011111100001001000001010010111010011011010000100100
11001111011110011101000001001110010010111001101111011101111101010101010101111101
11001000100111111110010001001011111010000100100010010111011100001010010101000110
01011011000111100101001110001011001111100110000101100010110001101001011100011101
10101101111101100000001001101001001001101001001001001010111010001001011111110101
11010100100101011011110010001000110000110000111111000111001101010000000001111100
01101111001000100101100110101010001011101110101011011000100100110100111011110000
10000110101111011101011010000000000001010111011111010000000011010111100011001001
00101100101010111001101001001101100001000001111110010111000001011110010100101101
11100110111101100010111111001000001011110100110101100100000101111110100111010100
11011101001010010010000110000101100100011000111010001100011111111011010010001110
00011011000010101101111011111000001010101000011100100000111100010110001110110001
01011001011110110000011110101000110010000010011001000101010000010011010110110000
01111111110111111111011001111100111011110000100101010111110100110101010111000100
00010111101111001100111100101010110010011110111000001100111001011001010111001000
11100111101110000101111110001100111011010011001010110111001100000011101011000101
01010011010111100110110110110110001110000101111001100000010011111111011001001000
11000011000111010010010101001011110000110000110000001111000100000100000010111101
00011011111011101101101101100000011000010101111101100111101001110110101110111100
11100011100101100100011000000001100110011101110100011010110011011000011111010101
11001010111110011110000110100101001101111010001111001001010010010100101000001010
11011101001101110101010110000111011000001001010110010000110011111010001011110000
00001110110001111110111010010010111001110001111101010101111000110100011010001110
10011110100100111010101011001101110011111100110111001101110010001000001000010011
00011010000100101101110011001111001110001000011010101101101001011111000110011001
11000111101101001011101010110101101000010100000000110011011111011001110011111001
00001110111001011100010010011000100100111101001100110111110100100011110010010100
10001101110011011100001100100000101110011110001101000000110001101011101010000111
10001101101100111000100111110011101000101001011110011010100010001001101101011010
11101000011010100010100110001010011010001010111010101010110000010010001010010101
10010000000111110001000111001110111111111110110001111111111111101011111100100011
1110110000001001000001110110111111100000011010001001110000011111
```

### Les courbes de Bézier ###

Je commence à penser qu'il est possible de tracer un chemin passant par toutes les cellules contenant un caractère en utilisant les 4 courbes fournies (et des copies, éventuellement en miroir). Chaque cellule marquée semble en effet être très précisément à une courbe de distance d'une autre cellule (parfois plusieurs). L'extrémité en crochet d'une des courbes laisse penser que le chemin doit contourner certaines cellules. On peut par exemple imaginer que les courbes ne doivent pas se croiser, ou qu'il ne faut pas faire passer un chemin au dessus d'une cellule marquée. A tester.

### La trame de fond ###

Une trame de fond est détectable sur l'ensemble de l'image. On peut la mettre en évidence via une solarisation (appliquer un courbe de colorimétrique en triangle). Je n'ai rien pu extraire de cette trame pour le moment. De plus, elle est fortement influencée par l'image d'origine. Il est peut être nécessaire de reconstituer un tuile "propre" du motif en extrayant uniquement les pixels des zones sur fond blanc.

![Challenge](/images/challenge-trame.png "Challenge")

## Ressources

- Site du challenge : [https://bitcoinchallenge.codes](https://bitcoinchallenge.codes)
- Conversion d'image en binaire : [https://www.dcode.fr/image-binaire](https://www.dcode.fr/image-binaire)

